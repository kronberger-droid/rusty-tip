# Tip Preparation Configuration
# This config uses linear pulse method with adaptive voltage response

[nanonis]
host_ip = "127.0.0.1"
control_ports = [6501, 6502, 6503, 6504]

[data_acquisition]
data_port = 6590
sample_rate = 2000

[experiment_logging]
enabled = true
output_path = "./experiments"

[console]
verbosity = "info"

[tip_prep]
# Frequency shift bounds for determining if tip is sharp
sharp_tip_bounds = [-2.0, 0.0]

# Maximum allowed change in frequency shift for tip to be considered stable
stable_tip_allowed_change = 0.2

# Whether to check for tip stability
check_stability = true

# Maximum number of pulse cycles (unlimited if not set)
max_cycles = 10000

# Maximum duration in seconds (unlimited if not set)
max_duration_secs = 12000

[pulse_method]
# Use linear pulse method
type = "linear"

# Frequency shift range to monitor (in Hz)
# When freq_shift is outside this range, pulse with upper clamp voltage
# When inside, calculate pulse voltage linearly based on freq_shift value
voltage_bounds = [-2.0, 0.0]

# Output pulse voltage range (in V)
# Maps the voltage_bounds range linearly to this pulse voltage range
# Example: freq_shift = -2.0 Hz → pulse = 2.0 V
#          freq_shift = -1.0 Hz → pulse = 4.0 V
#          freq_shift =  0.0 Hz → pulse = 6.0 V
linear_clamp = [2.0, 6.0]

# Polarity of the pulse voltage: "positive" or "negative"
polarity = "positive"

# Optional: Custom TCP channel mapping
# Uncomment and modify if your Nanonis signal indices differ from the defaults
# Format: { nanonis_index = X, tcp_channel = Y }
[[tcp_channel_mapping]]
nanonis_index = 76  # Frequency shift
tcp_channel = 19
